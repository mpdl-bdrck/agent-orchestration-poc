# PNP-017: Update main() Function to Detect SYSTEM_TRIGGER Messages

**Status**: ðŸ”´ To Do  
**Phase**: Phase 4 - Context Injection  
**Priority**: High  
**Assignee**: TBD

---

## Description

Update the `main()` function in `handlers.py` to detect and handle `SYSTEM_TRIGGER:` messages from notification clicks.

## Acceptance Criteria

- [ ] Detects `SYSTEM_TRIGGER:` prefix in message content
- [ ] Extracts context from trigger message
- [ ] Creates human-readable message for chat display
- [ ] Uses extracted context as actual message content for graph
- [ ] Graph routes to appropriate agent based on context
- [ ] Handles missing context gracefully

## Related Files

- `src/interface/chainlit/handlers.py` (update `main()` function)

## Dependencies

- PNP-014 (click handler must send SYSTEM_TRIGGER messages)

## Notes

See implementation plan section "5. Context Injection Handler" for format and examples.

